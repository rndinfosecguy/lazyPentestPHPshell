import base64
import sys

with open(sys.argv[1], 'r') as f:
    content = f.readlines()

newContent = ""
skipLine = 0
for line in content:
    line = line.strip()
    if "//" in line:
        continue
    if "/*" in line:
        skipLine = 1
        continue
    if "*/" in line:
        skipLine = 0
        continue
    if skipLine == 1:
        continue

    newContent += line + ' '

newContent = newContent.replace('<?php', '')
newContent = newContent.strip()
newContent = str(base64.b64encode(newContent.encode('ascii')))
newContent = newContent.replace('b\'', '')
newContent = newContent.replace('\'', '')
newContent = "<?php eval(base64_decode('" + newContent + "')); ?>"
print(newContent)
